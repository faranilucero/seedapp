USE baseline;

DROP TABLE IF EXISTS ORGS;
CREATE TABLE ORGS (
	ORG_ID bigint(20) NOT NULL AUTO_INCREMENT,
	ORG_NAME varchar(50) NULL,
	ORG_DESCRIPTION varchar(2000) NULL,
	PASSWORD_MIN_LENGTH int NULL,
	PASSWORD_MIN_UPPERCASE int NULL,
	PASSWORD_MIN_LOWERCASE int NULL,
	PASSWORD_MIN_NUMBERS int NULL,
	PASSWORD_MIN_SYMBOLS int NULL,
	PASSWORD_MIN_DAYS_EXPIRE int NULL,
	PASSWORD_MIN_REMEMBER_PREVIOUS int NULL,
	PRIMARY KEY (ORG_ID)
) ENGINE=InnoDb DEFAULT CHARSET=utf8;


DROP TABLE IF EXISTS PERMISSIONS;
CREATE TABLE PERMISSIONS(
	PERMISSION_ID bigint(20) NOT NULL AUTO_INCREMENT,
	PERMISSION_NAME varchar(50) NULL,
	PERMISSION_DESCRIPTION varchar(2000) NULL,
	ORG_ID bigint(20) NOT NULL,
	PRIMARY KEY (PERMISSION_ID, ORG_ID)
) ENGINE=InnoDb DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS USERS;
CREATE TABLE USERS (
	USER_ID bigint(20) NOT NULL AUTO_INCREMENT,
	USER_FIRST_NAME varchar(500) NULL,
	USER_MIDDLE_NAME varchar(500) NULL,
	USER_LAST_NAME varchar(500) NULL,
	USER_EMAIL_ADDRESS varchar(500) NULL,
	EMAIL_VERIFIED boolean NULL,
	ACTIVE boolean NULL,
	LOCKED_OUT boolean NULL,
	ORG_ID bigint(20) NOT NULL,
    PRIMARY KEY (USER_ID, ORG_ID)    
) ENGINE=InnoDb DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS USER_PASSWORDS;
CREATE TABLE USER_PASSWORDS (
	USER_ID bigint(20) NOT NULL,
	TIME_STAMP timestamp DEFAULT CURRENT_TIMESTAMP,
	USER_PASSWORD_HASH varchar(255) NOT NULL,
	PRIMARY KEY (USER_ID, TIME_STAMP)
) ENGINE=InnoDb DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS USER_GROUPS;
CREATE TABLE USER_GROUPS (
	USER_GROUP_ID bigint(20) NOT NULL AUTO_INCREMENT,
	USER_GROUP_NAME varchar(500) NULL,
	ORG_ID bigint(20) NOT NULL,
	PRIMARY KEY (USER_GROUP_ID, ORG_ID)
) ENGINE=InnoDb DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS USER_GROUP_USERS;
CREATE TABLE USER_GROUP_USERS (
	USER_GROUP_ID bigint(20) NOT NULL,
	USER_ID bigint(20) NOT NULL,
	PRIMARY KEY (USER_GROUP_ID, USER_ID)
) ENGINE=InnoDb DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS USER_GROUP_PERMISSIONS;
CREATE TABLE USER_GROUP_PERMISSIONS (
	USER_GROUP_ID bigint(20) NOT NULL,
	PERMISSION_ID bigint(20) NOT NULL,
	PRIMARY KEY (USER_GROUP_ID, PERMISSION_ID)
) ENGINE=InnoDb DEFAULT CHARSET=utf8;
